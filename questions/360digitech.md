Netty 多线程

HttpURLConnection

1. Dubbo 如何实现 RPC 调用

https://juejin.cn/post/6844904083820642317

dubbo 工作原理
第一层：service 层，接口层，给服务提供者和消费者来实现的

第二层：config 层，配置层，主要是对 dubbo 进行各种配置的

第三层：proxy 层，服务代理层，无论是 consumer 还是 provider，dubbo 都会给你生成代理，代理之间进行网络通信

第四层：register 层，服务注册层，负责服务的注册与发现

第五层：cluster 层，集群层，封装多个服务提供者的路由以及负载均衡，将多个实例组合成一个服务

第六层：monitor 层，监控层，对 rpc 接口的调用次数和调用时间进行监控

第七层：protocal 层，远程调用层，封装 rpc 调用

第八层：exchange 层，信息交换层，封装请求响应模式，同步转异步

第九层：transport 层，网络传输层，抽象 mina 和 netty 为统一接口

第十层：serialize 层，数据序列化层

工作流程
第一步：provider 向注册中心去注册

第二步：consumer 从注册中心订阅服务，注册中心会通知 consumer 注册好的服务

第三步：consumer 调用 provider

第四步：consumer 和 provider 都异步通知监控中心

![dubbo](https://ask.qcloudimg.com/http-save/yehe-2214790/dqimwyw65h.jpeg)

2. 线程问题：用到线程池吗，怎么配置核心线程数与最大线程数，其他参数怎么配置
    FixedThreadPool

3. JVM 问题：一个程序内存占用高，怎么定位问题

    1. 定位进程： 通过 top -c 或者 htop 定位到具体进程 拿到进程 ID
    
    2. 定位线程： 通过 top -H -p [进程id] 定位占内存的线程


4. 内存问题：怎么处理内存泄漏和内存溢出问题

    内存溢出就是你要求分配的内存超出了系统能给你的，系统不能满足需求，于是产生溢出。

    Java内存泄漏就是没有及时清理内存垃圾，导致系统无法再给你提供内存资源（内存资源耗尽）。

    看到上面的解释，可能有些朋友还是不太理解吧。没问题，看以下例子:

    1. Java内存泄露是说程序逻辑问题,造成申请的内存无法释放.这样的话无论多少内存,早晚都会被占用光的.
    最简单的例子就是死循环了.由于程序判断错误导经常发生此事。

    2. Java内存泄漏是指在堆上分配的内存没有被释放，从而失去对其控制。这样会造成程序能使用的内存越来越少，导致系统运行速度减慢，严重情况会使程序当掉。

    3.关于内存溢出有点出入。比如说你申请了一个integer,但给它存了long才能存下的数，那就是内存溢出。

    Q: 如何避免内存泄露、溢出？
    A: 
    1)尽早释放无用对象的引用。

    好的办法是使用临时变量的时候，让引用变量在退出活动域后自动设置为null，暗示垃圾收集器来收集该对象，防止发生内存泄露。

    2) 程序进行字符串处理时，尽量避免使用String，而应使用StringBuffer。

    3) 尽量少用静态变量。

    因为静态变量是全局的，GC不会回收。

    4)避免集中创建对象尤其是大对象，如果可以的话尽量使用流操作。

    5)尽量运用对象池技术以提高系统性能。

    生命周期长的对象拥有生命周期短的对象时容易引发内存泄漏，例如大集合对象拥有大数据量的业务对象的时候，可以考虑分块进行处理，然后解决一块释放一块的策略。

    6)不要在经常调用的方法中创建对象，尤其是忌讳在循环中创建对象。

    可以适当的使用hashtable，vector创建一组对象容器，然后从容器中去取那些对象，而不用每次new之后又丢弃。

    7) 优化配置。

5. 服务器问题：配置Tomcat（Jetty)
6. 网络问题： http请求是怎么请求的，tcp怎么保证数据可靠性的, 为什么要用https

## HTTP 请求的格式 组成

    1. 请求行：请求类型，资源URL，HTTP版本
    2. 请求头：紧接着请求行，一些服务器要使用的附加信息
    3. 空行： 请求头后面的空行是必须的
    4. 请求数据：也叫body，可以添加任意的数据。

## HTTP 状态码

1XX：请求已被接受正在处理，2XX:请求成功，3XX:重定向，4XX:客户端错误，5XX:服务器错误

## HTTP 步骤

    1. 建立连接：客户端与服务器端口建立TCP连接

    2. 发送HTTP请求：通过TCP的第三次握手发送HTTP文本请求

    3. 服务器接受请求并返回HTTP响应 

    4. 释放TCP连接

    5. 

## HTTP 三大风险：

    1. 窃听风险（eavesdropping）：第三方可以获知通信内容。

    2. 篡改风险（tampering）：第三方可以修改通信内容。

    3. 冒充风险（pretending）：第三方可以冒充他人身份参与通信。

## HTTPS 解决方案

    1. 所有信息都是加密传播，第三方无法窃听。

    2. 具有校验机制，一旦被篡改，通信双方会立刻发现。

    3. 配备身份证书，防止身份被冒充。

7. Redis问题：配置Redis，怎么让数据储存到不同的节点，Redis有哪些数据结构，如何解决TOP10问题。

## Redis 的数据结构

String、Hash、List、Set、SortedSet。

8. IO问题：NIO 相比 BIO 有什么优点